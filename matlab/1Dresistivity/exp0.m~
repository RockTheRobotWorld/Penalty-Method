%% setup
n  = 51;
f  = 5;
x  = linspace(0,1,n-1);
mt = 1 + exp(-1e1*(x-.5).^2);
%mt = ones(n-1,1);mt(1:floor(n/2))=2;

%% data
At = getA(f,mt);
Q  = speye(n);
Q  = Q(:,[1:10:end]);
Dt = Q'*(At\(Q));

M = size(Q,2);
%% factorization
m0 = ones(n-1,1);
A0 = getA(f,m0);
mu = eigmax(@(x)A0'\(Q*Q'*(A0\v0)),n);

lambda = 1e-2*mu;


[V,D]   = eig(full(A0'*A0));
[Vt,Dt] = eig(full((A0'*A0) + (1/lambda)*(Q*Q')));

figure; plot(1:n,diag(D),1:n,diag(Dt))

figure; plot(1:n,diag(Dt)-diag(D),1:n,ones(n,1)/lambda);

sum((diag(Dt)-diag(D))*lambda)

[(1+M/lambda/D(end,end))*D(end,end)/D(1,1)  Dt(end,end)/Dt(1,1)] 